/*******************************************************************************************************************************//**
 *
 * @file		DR_HC_SR04.c
 * @brief		Sensor de ultrasonido
 * @date
 * @author
 *
 **********************************************************************************************************************************/

/***********************************************************************************************************************************
 *** INCLUDES
 **********************************************************************************************************************************/
#include "../inc/DR_HC_SR04.h"
#include "../inc/DR_GPIO.h"

/***********************************************************************************************************************************
 *** DEFINES PRIVADOS AL MODULO
 **********************************************************************************************************************************/

/***********************************************************************************************************************************
 *** MACROS PRIVADAS AL MODULO
 **********************************************************************************************************************************/

/***********************************************************************************************************************************
 *** TIPOS DE DATOS PRIVADOS AL MODULO
 **********************************************************************************************************************************/

/***********************************************************************************************************************************
 *** TABLAS PRIVADAS AL MODULO
 **********************************************************************************************************************************/

/***********************************************************************************************************************************
 *** VARIABLES GLOBALES PUBLICAS
 **********************************************************************************************************************************/

/***********************************************************************************************************************************
 *** VARIABLES GLOBALES PRIVADAS AL MODULO
 **********************************************************************************************************************************/

/***********************************************************************************************************************************
 *** PROTOTIPO DE FUNCIONES PRIVADAS AL MODULO
 **********************************************************************************************************************************/

 /***********************************************************************************************************************************
 *** FUNCIONES PRIVADAS AL MODULO
 **********************************************************************************************************************************/

 /***********************************************************************************************************************************
 *** FUNCIONES GLOBALES AL MODULO
 **********************************************************************************************************************************/

/**
	\fn  init_hc_sr04
	\brief Inicializacion del sensor de ultrasonido
 	\author
 	\date
 	\param [in]
 	\param [out]
	\return
*/
void init_hc_sr04() {
	GPIO_Pinsel(TRIGGER, PINSEL_GPIO);
	GPIO_Pinsel(ECHO, PINSEL_GPIO);

	GPIO_Dir( TRIGGER, OUTPUT);
	GPIO_Dir( ECHO, INPUT);

	GPIO_Mode(ECHO, NONE);

	GPIO_Set(TRIGGER, OFF);
}

/**
	\fn  trigger_turn_on
	\brief Coloca una señal HIGH en pin de trigger
 	\author
 	\date
 	\param [in] Puerto puerto a seleccionar
 	\param [in] Pin del micro que vamos a configurar
 	\param [in] Funcion: la funcion que queremos que cumpla ese pin
 	\param [out]
	\return
*/
void trigger_turn_on() {
	GPIO_Set(TRIGGER, ON);
}

/**
	\fn  trigger_turn_off
	\brief Coloca una señal LOW en pin de trigger
 	\author
 	\date
 	\param [in]
 	\param [out]
	\return
*/
void trigger_turn_off() {
	GPIO_Set(TRIGGER, OFF);
}

/**
	\fn  echo_off
	\brief Consultamos el estado del PIN del ECHO si esta apagado
 	\author
 	\date
 	\param [in]
 	\param [out]
	\return uint8_t estado del pin del ECHO
*/
uint8_t echo_off() {
	return !GPIO_Get(ECHO);
}

/**
	\fn  echo_on
	\brief Consultamos el estado del PIN del ECHO si esta prendido
 	\author
 	\date
 	\param [in]
 	\param [out]
	\return
*/
uint8_t echo_on() {
	return GPIO_Get(ECHO);
}


