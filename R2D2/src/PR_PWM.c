/*******************************************************************************************************************************//**
 *
 * @file	PR_PWM.c
 * @brief	Primitivas para trabajar con los PWM
 * @date
 * @author	Cristian Usigas
 *
 **********************************************************************************************************************************/

/***********************************************************************************************************************************
 *** INCLUDES
 **********************************************************************************************************************************/
#include "../inc/DR_outputs.h"
#include "../inc/PR_PWM.h"
/***********************************************************************************************************************************
 *** DEFINES PRIVADOS AL MODULO
 **********************************************************************************************************************************/

/***********************************************************************************************************************************
 *** MACROS PRIVADAS AL MODULO
 **********************************************************************************************************************************/

/***********************************************************************************************************************************
 *** TIPOS DE DATOS PRIVADOS AL MODULO
 **********************************************************************************************************************************/

/***********************************************************************************************************************************
 *** TABLAS PRIVADAS AL MODULO
 **********************************************************************************************************************************/

/***********************************************************************************************************************************
 *** VARIABLES GLOBALES PUBLICAS
 **********************************************************************************************************************************/


/***********************************************************************************************************************************
 *** VARIABLES GLOBALES PRIVADAS AL MODULO
 **********************************************************************************************************************************/

/***********************************************************************************************************************************
 *** PROTOTIPO DE FUNCIONES PRIVADAS AL MODULO
 **********************************************************************************************************************************/

 /***********************************************************************************************************************************
 *** FUNCIONES PRIVADAS AL MODULO
 **********************************************************************************************************************************/

 /***********************************************************************************************************************************
 *** FUNCIONES GLOBALES AL MODULO
 **********************************************************************************************************************************/

/**
	\fn  moveteMotorPWM
	\brief
 	\author
 	\date
 	\param [in] motor : que paso a paso se quiere mover
 	\param [in]	estado : encendido o apagado
 	\param [in] direccion : IZQ o DER
 	\param [out]
	\return
*/
void moveteMotorPWM(int motor,int estado,int direccion)
{
	switch(motor) {
	case PWM1:
		buffer_salidas.PWM_1 = estado;
		buffer_salidas.PWM_DIR_1 = direccion;
		break;
	case PWM2:
			buffer_salidas.PWM_2 = estado;
			buffer_salidas.PWM_DIR_2 = direccion;
			break;
	case PWM3:
			buffer_salidas.PWM_3 = estado;
			buffer_salidas.PWM_DIR_3 = direccion;
			break;
	case PWM4:
			buffer_salidas.PWM_4 = estado;
			buffer_salidas.PWM_DIR_4 = direccion;
			break;
	case PWM5:
			buffer_salidas.PWM_5 = estado;
			buffer_salidas.PWM_DIR_5 = direccion;
			break;
	case PWM6:
			buffer_salidas.PWM_6 = estado;
			buffer_salidas.PWM_DIR_6 = direccion;
			break;
	}
}

/**
	\fn  turnOnPWM
	\brief Habilitamos el ENABLE de los motores paso a paso, por seguridad todos tienen que estar apagados
 	\author
 	\date
 	\param [in] on : Habilita o Deshabilita el ENABLE
 	\param [out]
	\return
*/
void turnOnPWM(uint8_t on) {
	moveteMotorPWM(TOWER_MOTOR, OFF, IZQ);
	moveteMotorPWM(BASE_MOTOR, OFF, IZQ);
	moveteMotorPWM(KNIFES_MOTOR, OFF, IZQ);
	buffer_salidas.PWM_ENABLE = on;
}
